@using Fotiv_Automator.Areas.GamePortal;
@model Fotiv_Automator.Areas.GamePortal.ViewModels.Forms.GameForm
@{
    ViewBag.Title = string.Format("Game Settings");

    bool isGMOrAdmin = Fotiv_Automator.Infrastructure.Attributes.RequireGMAdminAttribute.IsGMOrAdmin();
}

<div class="row">
    <div class="col-md-6">
        @using (Html.BeginForm())
        {
            <div class="hidden" id="anti-forgery-container">
                @Html.AntiForgeryToken()
            </div>

            @Html.ValidationSummary()

            <div>
                @Html.LabelFor(x => x.GameID)
                @Html.DisplayTextFor(x => x.GameID)
                @Html.HiddenFor(x => x.GameID)
            </div>

            <div>
                @Html.LabelFor(x => x.Name)

                @if (isGMOrAdmin)
                {
                    @Html.EditorFor(x => x.Name);
                }
                else
                {
                    @Html.DisplayTextFor(x => x.Name);
                }
            </div>

            <div>
                @Html.LabelFor(x => x.Description)
                @if (isGMOrAdmin)
                {
                    @Html.TextAreaFor(x => x.Description);
                }
                else
                {
                    @Html.DisplayTextFor(x => x.Description);
                }
            </div>

            <div>
                @Html.LabelFor(x => x.OpenedToPublic)
                @if (isGMOrAdmin)
                {
                    @Html.CheckBoxFor(x => x.OpenedToPublic)
                }
                else
                {
                    if (Model.OpenedToPublic)
                    {
                        <p>Public</p>
                    }
                    else
                    {
                        <p>Private</p>
                    }
                }
            </div>

            <div class="panel panel-info">
                <div class="panel-heading">Game Masters</div>
                <div class="panel-body potentialGMEditor">
                    <ul class="trait-select">
                        @for (var i = 0; i < Model.PotentialGMs.Count; i++)
                        {
                            if (isGMOrAdmin)
                            {
                                <li>
                                    @Html.HiddenFor(x => x.PotentialGMs[i].ID)

                                    @Html.DisplayFor(x => x.PotentialGMs[i].Name)
                                    @Html.HiddenFor(x => x.PotentialGMs[i].Name)

                                    @Html.CheckBoxFor(x => x.PotentialGMs[i].IsChecked)
                                </li>
                            }
                            else
                            {
                                <li>
                                    <p>@Model.PotentialGMs[i].Name</p>
                                </li>
                            }
                        }
                    </ul>
                </div>
            </div>

            if (isGMOrAdmin)
            {
                <div>
                    <input class="btn btn-default editButton" type="submit" value="Update Game" />
                </div>
            }
        }
    </div>

    <div class="col-md-6">
        @if (isGMOrAdmin)
        {
            <h1>Quick Actions</h1>
            <h2>Main Actions</h2>
            <div class="btn-group">
                <a href="@Url.RouteUrl("NewCivilization")" class="btn btn-default">
                    New Civilization
                </a>
                <a href="@Url.RouteUrl("NewStarMap")" class="btn btn-default">
                    New Star Map
                </a>
            </div>

            <h2>Statistics Actions</h2>
            <div class="btn-group">
                <a href="@Url.RouteUrl("NewCivilizationTrait")" class="btn btn-default">
                    New Civilization Trait
                </a>
                <a href="@Url.RouteUrl("NewInfrastructure")" class="btn btn-default">
                    New Infrastructure
                </a>
                <a href="@Url.RouteUrl("NewResearch")" class="btn btn-default">
                    New Research
                </a>
                <a href="@Url.RouteUrl("NewShip")" class="btn btn-default">
                    New Ship
                </a>
                <a href="@Url.RouteUrl("NewShipRate")" class="btn btn-default">
                    New Ship Rate
                </a>
                <a href="@Url.RouteUrl("NewSpecies")" class="btn btn-default">
                    New Species
                </a>
                <a href="@Url.RouteUrl("NewTechLevel")" class="btn btn-default">
                    New Tech Level
                </a>
            </div>

            <h3>Sector Map</h3>
            <div class="btn-group">
                <a href="@Url.RouteUrl("NewPlanetTier")" class="btn btn-default">
                    New Planetary Tier
                </a>
                <a href="@Url.RouteUrl("NewPlanetType")" class="btn btn-default pull-right">
                    New Planet Type
                </a>
                <a href="@Url.RouteUrl("NewStarType")" class="btn btn-default pull-right">
                    New Star Type
                </a>
                <a href="@Url.RouteUrl("NewStarAge")" class="btn btn-default pull-right">
                    New Star Age
                </a>
                <a href="@Url.RouteUrl("NewRadiationLevel")" class="btn btn-default pull-right">
                    New Radiation Level
                </a>
                <a href="@Url.RouteUrl("NewStageOfLife")" class="btn btn-default pull-right">
                    New Stage of Life
                </a>
            </div>
        }

        <h1>Game Options</h1>
        <div class="btn-group">
            @if (isGMOrAdmin)
            {
                <a href="@Url.Action("Delete", "Game", new { gameID = Model.GameID })"
                   class="btn btn-danger"
                   data-delete="THIS ACTION IS FINAL. Are you sure you want to delete this?">
                    <i class="glyphicon glyphicon-remove"></i> Delete Game
                </a>
            }
            @if (GameState.Game.Players.Count > 1)
            {
                <a href="@Url.Action("LeaveGame", "Game", new { gameID = Model.GameID })"
                   class="btn btn-danger"
                   data-delete="THIS ACTION IS FINAL. Are you sure you want to leave this game?">
                    <i class="glyphicon glyphicon-remove"></i> Leave Game
                </a>
            }
        </div>
    </div>
</div>